name: Fixing security issues
on:
  schedule:
    - cron: "0 0 * * *" # At 12 PM (midnight) daily.
jobs:
  npm_audit_fix:
    runs-on: ubuntu-22.04
    defaults:
      run:
        shell: bash

    strategy:
      matrix:
        node-version: [ 18.x ]

    steps:
      - uses: actions/checkout@v3

      - name: Use Node.js ${{ matrix.node-version }}
        uses: actions/setup-node@v3
        with:
          node-version: ${{ matrix.node-version }}
          cache: 'npm'

      - name: Run fix
        run: |
          npm audit fix

      - name: Create PR
        uses: gr2m/create-or-update-pull-request-action@v1.x
        with:
          title: "[SECURITY] - NPM Audit Fix"
          body: "security fixes"
          branch: security/npm-audit-fix
          commit-message: "npm audit fix updates"
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
