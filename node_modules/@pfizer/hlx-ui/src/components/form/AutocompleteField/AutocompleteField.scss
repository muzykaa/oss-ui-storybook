@use '../../../sass/variables/deco';
@use '../../../sass/variables/colors';
@use '../../../sass/variables/box-model';
@use '../../../sass/variables/typography';
@use '../../../sass/mixins/input';
@use '../../../sass/mixins/text';
@use '../../../sass/mixins/list';
@use '../../../sass/mixins/img';

.autocomplete {
  $autocomplete: &;

  position: relative;

  & &__header {
    @include input.input;

    padding-right: 18px;
    transition-duration: .4s;
    transition-timing-function: ease-in-out;
    transition-property: background-color, border-color, color;
    display: flex;
    gap: box-model.$spacing-basic;

    .svg-image {
      @include img.icon-size;

      fill: colors.$color-disabled;
      transition: transform .2s ease-in-out, fill .2s ease-in-out;
      transform: rotate(0);
      cursor: pointer;
    }
  }

  & &__preview {
    display: flex;
    width: 100%;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    cursor: pointer;
    user-select: none;

    @include input.placeholder;
    @include text.plain-text;

    color: colors.$color-disabled;
  }

  &.active {
    #{$autocomplete}__header {
      border-radius: box-model.$spacing-small box-model.$spacing-small 0 0;
      border-color: colors.$color-link;
      background-color: colors.$color-main-bg;
      border-width: 1px;

      #{$autocomplete}__preview {
        color: colors.$color-main-bg;
      }

      .svg-image {
        transform: rotate(180deg);
        fill: colors.$color-main-bg;
      }
    }
  }

  &.disabled,
  &.disabled #{$autocomplete}__header,
  &.disabled #{$autocomplete}__input,
  &.disabled #{$autocomplete}__preview {
    cursor: not-allowed;
  }

  &.disabled,
  &.disabled.invalid,
  &.disabled.invalid.focus {
    .form-field__label {
      color: colors.$color-disabled;
    }

    #{$autocomplete}__header {
      border-color: colors.$color-disabled;
      background-color: colors.$color-disabled-3;
    }
  }

  #{$autocomplete}__input {
    background-color: transparent;
    border: none;
    box-shadow: none;
    outline: none;
    display: flex;
    width: 100%;
  }

  & &__option-list {
    padding: 14px 0;
    border: 1px solid colors.$color-link;
    border-radius: 0 0 box-model.$spacing-small box-model.$spacing-small;
    box-shadow: none;
    outline: none;
    position: absolute;
    top: 100%;
    left: 0;
    width: 100%;
    z-index: deco.$z-index-main;
    background-color: colors.$color-main-bg;
    margin-top: -1px;
  }

  & &__option-wrapper {
    max-height: 200px;
    overflow-y: auto;

    @include list.scroll-bar;
  }

  & &__input {
    @include input.input-text;
  }

  & &__option {
    padding: 10px box-model.$spacing-small;
    white-space: normal;
    word-break: keep-all;
    transition: background-color .2s ease-in-out, color .2s ease-in-out;
    background-color: transparent;
    cursor: pointer;

    &.active,
    &:hover {
      background-color: colors.$color-link;
      color: colors.$color-main-bg;
    }
  }

  .invalid > & {
    .svg-image {
      fill: colors.$color-danger;
    }

    #{$autocomplete}__header {
      border-color: colors.$color-danger;
    }
  }

  &.upside-down.active {
    #{$autocomplete}__header {
      border-radius: 0 0 box-model.$spacing-small box-model.$spacing-small;
    }

    #{$autocomplete}__option-list {
      top: unset;
      bottom: 100%;
      border-radius: box-model.$spacing-small box-model.$spacing-small 0 0;
      margin-top: unset;
      margin-bottom: -1px;
    }
  }
}
