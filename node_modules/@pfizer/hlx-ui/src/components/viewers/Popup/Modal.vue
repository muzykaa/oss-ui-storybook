<template>
  <Popup
    :model-value="modelValue"
    :title="title"
    :class-name="`${isLoading ? 'loading' : ''} ${className}`"
    mode="modal"
    @update:model-value="changeModelValueHandler"
  >
    <template #content>
      <slot />
    </template>
    <template #actions>
      <button type="button" class="secondary" :disabled="isLoading" @click="cancelClickHandler">
        {{ cancel || 'Cancel' }}
        <Icon v-if="cancelIcon" :name="cancelIcon" />
      </button>
      <button type="button" :disabled="isLoading" @click="acceptClickHandler">
        <Preloader v-if="isLoading" class-name="invert" />
        <template v-else>
          {{ accept || 'Accept' }}
        </template>
        <Icon v-if="acceptIcon" :name="acceptIcon" />
      </button>
    </template>
  </Popup>
</template>

<script lang="ts" setup>
import Popup from './Popup.vue';
import Preloader from '../Preloader/Preloader.vue';
import Icon from '../Icon/Icon.vue';

interface Props {
  title?: string;
  isLoading?: boolean;
  accept?: string;
  acceptIcon?: string;
  cancel?: string;
  cancelIcon?: string;
  modelValue: boolean;
  className?: string;
}
defineProps<Props>();

const emit = defineEmits(['update:modelValue', 'accept']);

const changeModelValueHandler = (newValue: boolean) => emit('update:modelValue', newValue);

const cancelClickHandler = () => emit('update:modelValue', false);

const acceptClickHandler = () => emit('accept');
</script>
