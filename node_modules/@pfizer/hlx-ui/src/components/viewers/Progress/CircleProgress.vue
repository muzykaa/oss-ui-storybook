<template>
  <div class="circle-progress">
    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" data-value="75">
      <circle r="45" cx="50" cy="50" class="circle-progress__frame" />
      <!-- 282.78302001953125 is auto-calculated by path.getTotalLength() -->
      <path
        class="circle-progress__meter"
        d="M5,50a45,45 0 1,0 90,0a45,45 0 1,0 -90,0"
        stroke-linecap="round"
        stroke-linejoin="round"
        :stroke-dashoffset="value"
        :stroke-dasharray="MAX_VALUE"
      />
      <!-- Value automatically updates based on data-value set above -->
      <text x="50" y="50" text-anchor="middle" dominant-baseline="central" class="circle-progress__text">
        {{ progress }}%
      </text>
    </svg>
    <slot />
  </div>
</template>

<script lang="ts" setup>
import { computed } from 'vue';

interface Props {
  progress: number;
}
const props = defineProps<Props>();

const MAX_VALUE = 282.78302001953125;
const value = computed(() => ((100 - props.progress) / 100) * MAX_VALUE);
</script>
