/**
 * Vue Number Format 3.34.1
 * (c) 2021-2023 Dipak Sarkar <hello@dipaksarkar.in> (https://dipaksarkar.in/)
 * @license MIT
 */
import{defineComponent as e,ref as t,computed as n,watch as i,resolveDirective as r,withDirectives as l,openBlock as u,createElementBlock as a}from"vue";var s={prefix:"",suffix:"",separator:",",decimal:".",precision:2,minimumFractionDigits:null,prefill:!0,reverseFill:!1,min:null,max:null,nullValue:""};function o(e){return t=0,n=e,i=20,Math.max(t,Math.min(n,i));var t,n,i}class p{options;input;number;isClean;preSurRegExp;numberRegExp;cleanRegExp;negativeRegExp;constructor(e){this.options=Object.assign(c(s),e);const{prefix:t,suffix:n,decimal:i,reverseFill:r}=this.options;this.input="",this.number="",this.isClean=!r;const l=t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),u=n.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&");this.preSurRegExp=new RegExp(`${l}|${u}`,"g"),this.numberRegExp=new RegExp(`[^0-9\\${i}]+`,"gi"),this.cleanRegExp=new RegExp("[^0-9]+","gi"),this.negativeRegExp=new RegExp("[^0-9\\-]+","gi")}isNull(){return!this.numberOnly(this.isClean?this.cleanRegExp:this.negativeRegExp)}clean(e=!1){return this.isClean=e,this}sign(){if(null===this.input||void 0===this.input)return"";const e=this.input.toString().indexOf("-")>=0;return this.isClean?e&&this.realNumber()>0?"-":"":e?"-":""}toFixed(){const e=Math.pow(10,this.options.precision);return(parseFloat(this.numberOnly(/\D+/g))/e||0).toFixed(o(this.options.precision))}toNumber(e){return Number(e)}numberOnly(e){return this.input?.toString().replace(this.preSurRegExp,"").replace(e||this.numberRegExp,"")}isNegative(){return"-"===this.sign()}numbers(){const{reverseFill:e,decimal:t}=this.options;return e?this.number=this.toFixed().replace(".",t):"number"==typeof this.input?this.number=this.parts(this.input.toString().replace("-",""),".").join(t):isNaN(this.toNumber(this.input))?this.number=this.parts(this.numberOnly()).join(t):this.number=this.parts(this.input.replace("-",""),".").join(t),this.number}unformatNumber(){return this.numbers().toString().replace(this.options.decimal,".")}realNumber(){return parseFloat(this.unformatNumber())}parts(e,t){const{precision:n,minimumFractionDigits:i,decimal:r}=this.options;let l=e.toString().split(t||r);if(l.length>1&&(l[0]=this.toNumber(l[0])||0,l[1]=l.slice(1,l.length).join(""),l=l.slice(0,2)),this.isClean){const e=this.toNumber(l.join(".")).toFixed(n),t=this.toNumber(e),r=t.toFixed(i);l=i>=0&&t.toString().length<r.length?r.toString().split("."):t.toString().split(".")}return l.slice(0,2)}addSeparator(){const{decimal:e,separator:t}=this.options,n=this.numbers().split(e);return n[0]=n[0].toString().replace(/(\d)(?=(?:\d{3})+\b)/gm,`$1${t}`),n.join(e)}format(e){this.input=e;const{reverseFill:t,nullValue:n,prefix:i,suffix:r}=this.options;return this.isNull()&&!t?n:this.sign()+i+this.addSeparator()+r}unformat(e){this.input=e;const{reverseFill:t,nullValue:n}=this.options,i=this.realNumber(),r=this.unformatNumber();return this.isNull()||t&&0===i?n:this.sign()+r}}const m="-";function c(e){return JSON.parse(JSON.stringify(e))}function d(e){return new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:{facade:!0}})}function v(e){const t=e instanceof HTMLInputElement?e:e.querySelector("input");if(!t)throw new Error("number directive requires an input element");return t}function f(e,t){const n=()=>{e.setSelectionRange(t,t)};n(),setTimeout(n,1)}function h(e,t,{emit:n=!0,force:i=!1,clean:r=!1}={}){const{options:l,oldValue:u}=e,{reverseFill:a,max:s,min:o}=l,m=t?.props?.value||e.value;if(i||u!==m){const t=new p(l).clean(r&&!a);let i=t.format(m),u=t.clean(!a).unformat(m);return r&&(Number(s)===s&&Number(u)>s?(i=t.format(s),u=s.toString()):Number(o)===o&&Number(u)<o&&(i=t.format(o),u=o.toString())),e.oldValue=i,e.unmasked=u,e.value!==i&&(e.value=i),n&&e.dispatchEvent(d("input"))}}var g={beforeMount:(e,{value:t,modifiers:n},i)=>{e=v(e);const r=Object.assign(c(s),t,n),{reverseFill:l,precision:u,decimal:a}=r;e.options=r,e.setAttribute("inputmode","numeric"),l&&e.value?(e.value=parseFloat(new p({...r,reverseFill:!1}).unformat(e.value)).toFixed(u),i?.props?.value&&(i.props.value=e.value)):e.value&&!isNaN(Number(e.value))&&(e.value=e.value.replace(".",a)),h(e,i,{force:r.prefill,clean:!0,emit:!1})},mounted:e=>{const t=(e=v(e)).parentElement||e,n=t=>{t.target===e&&function(e){const{target:t,detail:n}=e;if(n?.facade)return!1;e.stopPropagation();let i=t.value.length;const{oldValue:r,options:l}=t;t.selectionEnd&&(i=t.value.length-t.selectionEnd),h(t,null,{clean:!l.precision,emit:!1}),l.suffix&&(i=Math.max(i,l.suffix.length)),i=t.value.length-i,l.prefix&&(i=Math.max(i,l.prefix.length)),f(t,i),r!==t.value&&t.dispatchEvent(d("input"))}(t)},i=t=>{t.target===e&&function(e){const{target:t}=e,{oldValue:n}=t;h(t,null,{force:!0,clean:!0,emit:!1}),n!==t.value&&t.dispatchEvent(d("input"))}(t)},r=t=>{t.target===e&&function(e,t){const{options:n}=t,{prefix:i,suffix:r,decimal:l,min:u,separator:a}=n,{key:s}=e,o=new RegExp(`${i}|${r}`,"g"),p=t.value.replace(o,""),c=void 0===u||Number(u)<0||Number(u)!==u;if(s===l)p.includes(l)?e.preventDefault():p||(t.value="0"+l,t.dispatchEvent(new Event("input")));else if(s!==m||c){if("Backspace"===s){const n=t.selectionEnd||0,l=t.value.slice(n-1,n),u=t.value.slice(n-2,n);let s=t.value.length-n;[i,m,a].includes(l)&&(e.preventDefault(),t.value=l===a?t.value.replace(u,""):t.value.replace(new RegExp(`[${i}${m}]`,"g"),""),s=Math.max(s,r.length),s=t.value.length-s,s=Math.max(s,i.length),f(t,s),t.dispatchEvent(new Event("input")))}}else e.preventDefault()}(t,e)};t.addEventListener("input",n,!0),t.addEventListener("blur",i,!0),t.addEventListener("keydown",r,!0),e.cleanup=()=>{t.removeEventListener("input",n,!0),t.removeEventListener("blur",i,!0),t.removeEventListener("keydown",r,!0)}},updated:(e,{value:t,oldValue:n,modifiers:i},r)=>{if(e=v(e),t!==n){const n=e.options;e.options=Object.assign(n,t,i),h(e,r,{force:!0,clean:!1,emit:!1})}else h(e,r,{emit:!1})},unmounted:e=>{v(e).cleanup()}};const b=c(s);var x=e({name:"VueNumber",directives:{number:g},props:{modelValue:{type:[String,Number],required:!0},nullValue:{type:[Number,String],default:b.nullValue},masked:Boolean,readonly:Boolean,disabled:Boolean,reverseFill:{type:Boolean,default:b.reverseFill},prefill:{type:Boolean,default:b.prefill},precision:{type:Number,default:()=>b.precision},minimumFractionDigits:{type:Number,default:()=>b.minimumFractionDigits},decimal:{type:String,default:()=>b.decimal},min:{type:Number,default:()=>b.min},max:{type:Number,default:()=>b.max},separator:{type:String,default:()=>b.separator},prefix:{type:String,default:()=>b.prefix},suffix:{type:String,default:()=>b.suffix}},emits:["update:model-value","input:model-value"],setup(e,{emit:r}){const l=t(e.modelValue),u=t(!1),a=t(""),s=n((()=>({...e}))),o=new p(s.value),m=n((()=>e.masked?o.format(l.value):a.value)),c=()=>{r("update:model-value",m.value)};return i((()=>e.modelValue),(e=>{const t=o.format(e);t!==l.value&&(l.value=t)})),{config:s,maskedValue:l,unmaskedValue:a,input:e=>{const{target:t}=e;l.value=t.value,a.value=t.unmasked,u.value=!0,r("input:model-value",m.value)},blur:()=>{u.value&&m.value!==e.modelValue&&c()},change:c}}});const E=["value","readonly","disabled"];x.render=function(e,t,n,i,s,o){const p=r("number");return l((u(),a("input",{type:"text",autocomplete:"off",value:e.maskedValue,readonly:e.readonly,disabled:e.disabled,class:"v-number vue-number-format",onChange:t[0]||(t[0]=(...t)=>e.change&&e.change(...t)),onInput:t[1]||(t[1]=(...t)=>e.input&&e.input(...t)),onBlur:t[2]||(t[2]=(...t)=>e.blur&&e.blur(...t))},null,40,E)),[[p,e.config]])},x.__file="src/component.vue";const N={install(e,t){t&&Object.assign(s,t),e.directive("number",g),e.component("VueNumber",x)}};export{p as NumberFormat,x as component,N as default,g as directive,s as options};
